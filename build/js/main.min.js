document.addEventListener("DOMContentLoaded", (e) => {
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // addAnchorsToLinks
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  const body = document.body,
    darkAnchr = document.querySelectorAll(".dark-anchr"),
    whiteAnchr = document.querySelectorAll(".white-anchr");

  if (body.classList.contains("dark")) {
    lottie.loadAnimation({
      container: document.querySelector(".presentation__title"),
      renderer: "svg",
      rendererSettings: {
        className: "dark-logo",
      },
      loop: false,
      autoplay: true,
      path: "images/lottie-json/bg-dark.json",
    });

    darkAnchr.forEach((anc) => {
      anc.setAttribute("href", "#header");
    });
  } else if (body.classList.contains("white")) {
    lottie.loadAnimation({
      container: document.querySelector(".presentation__title"),
      renderer: "svg",
      rendererSettings: {
        className: "white-logo",
      },
      loop: false,
      autoplay: true,
      path: "images/lottie-json/bg-white.json",
    });

    whiteAnchr.forEach((anc) => {
      anc.setAttribute("href", "#header");
    });
  }

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // smoothScrollByAnchors
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

  const anchors = document.querySelectorAll('a[href*="#"]');
  for (let anchor of anchors) {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      const blockID = anchor.getAttribute("href").substr(1);
      if (blockID) {
        document.getElementById(blockID).scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }
    });
  }

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // calcScroll
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  function calcScroll() {
    let div = document.createElement("div");

    div.style.width = "50px";
    div.style.height = "50px";
    div.style.overflowY = "scroll";
    div.style.visibility = "hidden";

    document.body.appendChild(div);
    let scrollWidth = div.offsetWidth - div.clientWidth;
    div.remove();

    return scrollWidth;
  }

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // then popup is open add padding
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

  let paddingScroll = calcScroll();

  fsLightboxInstances["lightbox"].props.onOpen = () => {
    document.body.style.paddingRight = `${paddingScroll}px`;
  };

  fsLightboxInstances["lightbox"].props.onClose = () => {
    document.body.style.paddingRight = `0`;
  };

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // visible header
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

  const invisible = document.querySelectorAll(".invisible *");
  const headerTimeout = setTimeout(() => {
    invisible.forEach((el) => {
      el.style.opacity = 1;
    });
  }, 1500);

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // Initialize sliders
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

  // ——————————————————————————————————————————————————
  // UsingAreasSlider
  // ——————————————————————————————————————————————————
  const prevUsingBtn = document.querySelector(".using-areas__pagination-prev"),
    nextUsingBtn = document.querySelector(".using-areas__pagination-next"),
    usCard = document.querySelectorAll(".using-card__card");

  const usingAreas = new Swiper(".using-card__container", {
    speed: 400,
    spaceBetween: 10,
    slidesPerView: 1,
    loop: true,
    navigation: {
      nextEl: ".using-areas__pagination-next",
      prevEl: ".using-areas__pagination-prev",
    },
    breakpoints: {
      551: {
        loop: false,
        slidesPerView: 2,
        spaceBetween: 40,
      },
      769: {
        loop: false,
        slidesPerView: 3,
        spaceBetween: 11,
      },
      1026: {
        loop: false,
        slidesPerView: 4,
      },
    },
  });

  // check resize slider
  function handleTabletChange(e) {
    if (e.matches) {
      usingAreas.on("slideChange", function (e) {
        if (this.activeIndex == 0) {
          this.slideTo(6, 1000);
        } else if (this.activeIndex == 7) {
          this.slideTo(1, 1000);
        }
      });
    }
  }
  const mediaQuery = window.matchMedia("(max-width: 551px)");
  mediaQuery.addListener(handleTabletChange);
  handleTabletChange(mediaQuery);

  // ——————————————————————————————————————————————————
  // DronicoSlider
  // ——————————————————————————————————————————————————
  const dronicoSlider = new Swiper(".dronico-slider__container", {
    parallax: true,
    speed: 500,
    slidesPerView: 1,
    loop: true,
    spaceBetween: 100,
    effect: "fade",
    fadeEffect: {
      crossFade: true,
    },
    grabCursor: true,
    navigation: {
      nextEl: ".dronico-slider__pagination-next",
      prevEl: ".dronico-slider__pagination-prev",
    },
  });
  const dronicoImgSlider = new Swiper(".dronico-slider__img-container", {
    parallax: true,
    speed: 500,
    slidesPerView: 1,
    loop: true,
    direction: "vertical",
    simulateTouch: false,
    mousewheelControl: false,
    freeMode: false,
    spaceBetween: 20,
  });
  const dronicoImgNumSlider = new Swiper(".dronico-slider__imgNum-container", {
    parallax: true,
    speed: 500,
    slidesPerView: 1,
    loop: true,
    mousewheelControl: false,
    freeMode: false,
    simulateTouch: false,
    effect: "fade",
    fadeEffect: {
      crossFade: true,
    },
    breakpoints: {
      769: {
        slidesPerView: 1,
        spaceBetween: 0,
      },
      1441: {
        spaceBetween: 100,
      },
    },
  });

  dronicoSlider.controller.control = dronicoImgNumSlider;
  dronicoImgNumSlider.controller.control = dronicoImgSlider;

  // ——————————————————————————————————————————————————
  // MobileDronicoSlider
  // ——————————————————————————————————————————————————
  const dronicoMobileSlider = new Swiper(".dronico-slider__mobile-container", {
    speed: 500,
    slidesPerView: 1,
    loop: true,
    mousewheelControl: false,
    freeMode: false,
    simulateTouch: false,
    effect: "fade",
    fadeEffect: {
      crossFade: true,
    },
    pagination: {
      el: ".dronico-slider__mobile-pagination",
      clickable: true,
    },
  });

  // ——————————————————————————————————————————————————
  // WorkSlider
  // ——————————————————————————————————————————————————
  const workSlider = new Swiper(".work__container", {
    speed: 400,
    slidesPerView: 6,
    spaceBetween: 20,
    navigation: {
      nextEl: ".work__navigation-next",
      prevEl: ".work__navigation-prev",
    },
  });

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // MainCode
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  const dronsContainer = document.querySelector(".tech-dronico__img-container"),
    dronsBtns = document.querySelectorAll(".tech-dronico__btn"),
    dronTexts = document.querySelectorAll(".tech-dronico__text"),
    active = "active-btn";

  if (dronsContainer) {
    dronsContainer.addEventListener("click", (e) => {
      const target = e.target;
      if (target.classList.contains("tech-dronico__btn")) {
        dronsBtns.forEach((btn) => {
          btn.classList.remove(active);
        });
        dronTexts.forEach((text) => {
          text.classList.remove(active);
          if (text.dataset.text == target.dataset.text) {
            text.classList.add(active);
            target.classList.add(active);
          }
        });
      }
    });
  }

  // ——————————————————————————————————————————————————
  // LottieSvgOnMouseOver
  // ——————————————————————————————————————————————————
  const techTab = document.querySelector(".technologies__tabs");
  if (techTab) {
    techTab.onmouseover = techTab.onmouseout = (e) => {
      const target = e.target;
      if (target.classList.contains("technologies__tab")) {
        const techLottie = target.querySelector(".lottie-tech");
        if (techLottie) {
          if (e.type == "mouseover") {
            techLottie.play();
            techLottie.setLooping(true);
          } else {
            techLottie.setLooping(false);
          }
        }
      }
    };
  }

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // FeedbackModal
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  function closeModal(modalSelector) {
    const modalWindow = document.querySelector(modalSelector);

    modalWindow.classList.remove("active");
  }

  function openModal(modalSelector) {
    const modalWindow = document.querySelector(modalSelector);

    modalWindow.classList.add("active");
  }

  function modal(triggerSelector, modalSelector) {
    const modalBtn = document.querySelectorAll(triggerSelector),
      modalWindow = document.querySelector(modalSelector);

    modalBtn.forEach((btn) => {
      btn.addEventListener("click", () => openModal(modalSelector));
    });

    modalWindow.addEventListener("click", (e) => {
      if (e.target.getAttribute("data-close") == "") {
        closeModal(modalSelector);
      }
    });

    window.addEventListener("keydown", (e) => {
      if (e.code === "Escape" && modalWindow.classList.contains("active")) {
        closeModal(modalSelector);
      }
    });
  }

  modal(".box", ".feedback");

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // Form
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  const form = document.querySelector(".feedback__form");
  form.addEventListener("submit", formSend);

  async function formSend(e) {
    e.preventDefault();

    let error = formValidate(form);

    const formData = new FormData(form);

    if (error === 0) {
      form.classList.add("._sending");
      let response = await fetch("php/sendmail.php", {
        method: "POST",
        body: formData,
      });
      if (response.ok) {
        let result = await response.json();
        alert(result.message);
        form.reset();
        form.classList.remove("_sending");
      } else {
        alert("Ошибка");
        form.classList.remove("_sending");
      }
    }
  }

  function formValidate(form) {
    let error = 0;
    const formReq = document.querySelectorAll("._req");

    for (let i = 0; i < formReq.length; i++) {
      const input = formReq[i];
      formRemoveError(input);

      if (input.classList.contains("_name")) {
        if (!/^\w{4,20}$/gi.test(input.value)) {
          formAddError(input);
        }
      } else if (input.classList.contains("_phone")) {
        if (!/^\d{4,12}$/g.test(input.value)) {
          formAddError(input);
        }
      } else if (
        input.getAttribute("type") === "checkbox" &&
        input.checked === false
      ) {
        formAddError(input);
        error++;
      } else if (input.value === "") {
        formAddError(input);
        error++;
      }
    }
    return error;
  }

  function formAddError(input) {
    input.parentElement.classList.add("_error");
    input.classList.add("_error");
    input.nextSibling.nextElementSibling.classList.add("_error");
  }

  function formRemoveError(input) {
    input.parentElement.classList.remove("_error");
		input.classList.remove("_error");
		input.nextSibling.nextElementSibling.classList.remove("_error");
  }

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // TextScramble
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

  class TextScramble {
    constructor(el) {
      this.el = el;
      this.chars = "0123456789><+-.%";
      this.update = this.update.bind(this);
    }
    setText(newText) {
      const oldText = this.el.innerText;
      const length = Math.max(oldText.length, newText.length);
      const promise = new Promise((resolve) => (this.resolve = resolve));
      this.queue = [];
      for (let i = 0; i < length; i++) {
        const from = oldText[i] || "";
        const to = newText[i] || "";
        const start = Math.floor(Math.random() * 40);
        const end = start + Math.floor(Math.random() * 40);
        this.queue.push({ from, to, start, end });
      }
      cancelAnimationFrame(this.frameRequest);
      this.frame = 0;
      this.update();
      return promise;
    }
    update() {
      let output = "";
      let complete = 0;
      for (let i = 0, n = this.queue.length; i < n; i++) {
        let { from, to, start, end, char } = this.queue[i];
        if (this.frame >= end) {
          complete++;
          output += to;
        } else if (this.frame >= start) {
          if (!char || Math.random() < 0.28) {
            char = this.randomChar();
            this.queue[i].char = char;
          }
          output += `<span class="dud">${char}</span>`;
        } else {
          output += from;
        }
      }
      this.el.innerHTML = output;
      if (complete === this.queue.length) {
        this.resolve();
      } else {
        this.frameRequest = requestAnimationFrame(this.update);
        this.frame++;
      }
    }
    randomChar() {
      return this.chars[Math.floor(Math.random() * this.chars.length)];
    }
  }
  const phrases = [
    "70.512323, 45.11974",
    "2.3513, -78.28398690",
    "74.32334, 24.34523",
    "-12.512323, 45.11974",
    "72.512344, 3.129043",
    "-70.512323, 20.11974",
    "83.123341, 42.75656",
  ];

  const numbers = document.querySelectorAll(".scrumble-text");

  function scrumbleText(fx, num) {
    fx = new TextScramble(num);
    let counter = 0;
    function next() {
      fx.setText(phrases[counter]).then(() => {
        setTimeout(next, 800);
      });
      counter = (counter + 1) % phrases.length;
    }
    next();
  }

  numbers.forEach((num, i) => {
    scrumbleText(`fx${i}`, num);
  });

  // Modal

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // Parallax
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

  const paralaxClass = ".rellax";

  const scenes = document.querySelectorAll(paralaxClass);
  scenes.forEach((scene) => {
    let parallax = new Parallax(scene, {
      relativeInput: true,
    });
  });

  const rellax = new Rellax(paralaxClass, {
    center: true,
  });

  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  // openVideo
  // ——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
  const dronicoSliderContainer = document.querySelector(
    ".dronico-slider__img-container"
  );
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIChlKSA9PiB7XHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgLy8gYWRkQW5jaG9yc1RvTGlua3NcclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keSxcclxuICAgIGRhcmtBbmNociA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZGFyay1hbmNoclwiKSxcclxuICAgIHdoaXRlQW5jaHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLndoaXRlLWFuY2hyXCIpO1xyXG5cclxuICBpZiAoYm9keS5jbGFzc0xpc3QuY29udGFpbnMoXCJkYXJrXCIpKSB7XHJcbiAgICBsb3R0aWUubG9hZEFuaW1hdGlvbih7XHJcbiAgICAgIGNvbnRhaW5lcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcmVzZW50YXRpb25fX3RpdGxlXCIpLFxyXG4gICAgICByZW5kZXJlcjogXCJzdmdcIixcclxuICAgICAgcmVuZGVyZXJTZXR0aW5nczoge1xyXG4gICAgICAgIGNsYXNzTmFtZTogXCJkYXJrLWxvZ29cIixcclxuICAgICAgfSxcclxuICAgICAgbG9vcDogZmFsc2UsXHJcbiAgICAgIGF1dG9wbGF5OiB0cnVlLFxyXG4gICAgICBwYXRoOiBcImltYWdlcy9sb3R0aWUtanNvbi9iZy1kYXJrLmpzb25cIixcclxuICAgIH0pO1xyXG5cclxuICAgIGRhcmtBbmNoci5mb3JFYWNoKChhbmMpID0+IHtcclxuICAgICAgYW5jLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgXCIjaGVhZGVyXCIpO1xyXG4gICAgfSk7XHJcbiAgfSBlbHNlIGlmIChib2R5LmNsYXNzTGlzdC5jb250YWlucyhcIndoaXRlXCIpKSB7XHJcbiAgICBsb3R0aWUubG9hZEFuaW1hdGlvbih7XHJcbiAgICAgIGNvbnRhaW5lcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcmVzZW50YXRpb25fX3RpdGxlXCIpLFxyXG4gICAgICByZW5kZXJlcjogXCJzdmdcIixcclxuICAgICAgcmVuZGVyZXJTZXR0aW5nczoge1xyXG4gICAgICAgIGNsYXNzTmFtZTogXCJ3aGl0ZS1sb2dvXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGxvb3A6IGZhbHNlLFxyXG4gICAgICBhdXRvcGxheTogdHJ1ZSxcclxuICAgICAgcGF0aDogXCJpbWFnZXMvbG90dGllLWpzb24vYmctd2hpdGUuanNvblwiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgd2hpdGVBbmNoci5mb3JFYWNoKChhbmMpID0+IHtcclxuICAgICAgYW5jLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgXCIjaGVhZGVyXCIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBzbW9vdGhTY3JvbGxCeUFuY2hvcnNcclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuXHJcbiAgY29uc3QgYW5jaG9ycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2FbaHJlZio9XCIjXCJdJyk7XHJcbiAgZm9yIChsZXQgYW5jaG9yIG9mIGFuY2hvcnMpIHtcclxuICAgIGFuY2hvci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBibG9ja0lEID0gYW5jaG9yLmdldEF0dHJpYnV0ZShcImhyZWZcIikuc3Vic3RyKDEpO1xyXG4gICAgICBpZiAoYmxvY2tJRCkge1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJsb2NrSUQpLnNjcm9sbEludG9WaWV3KHtcclxuICAgICAgICAgIGJlaGF2aW9yOiBcInNtb290aFwiLFxyXG4gICAgICAgICAgYmxvY2s6IFwic3RhcnRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBjYWxjU2Nyb2xsXHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgZnVuY3Rpb24gY2FsY1Njcm9sbCgpIHtcclxuICAgIGxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cclxuICAgIGRpdi5zdHlsZS53aWR0aCA9IFwiNTBweFwiO1xyXG4gICAgZGl2LnN0eWxlLmhlaWdodCA9IFwiNTBweFwiO1xyXG4gICAgZGl2LnN0eWxlLm92ZXJmbG93WSA9IFwic2Nyb2xsXCI7XHJcbiAgICBkaXYuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcblxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgbGV0IHNjcm9sbFdpZHRoID0gZGl2Lm9mZnNldFdpZHRoIC0gZGl2LmNsaWVudFdpZHRoO1xyXG4gICAgZGl2LnJlbW92ZSgpO1xyXG5cclxuICAgIHJldHVybiBzY3JvbGxXaWR0aDtcclxuICB9XHJcblxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIC8vIHRoZW4gcG9wdXAgaXMgb3BlbiBhZGQgcGFkZGluZ1xyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG5cclxuICBsZXQgcGFkZGluZ1Njcm9sbCA9IGNhbGNTY3JvbGwoKTtcclxuXHJcbiAgZnNMaWdodGJveEluc3RhbmNlc1tcImxpZ2h0Ym94XCJdLnByb3BzLm9uT3BlbiA9ICgpID0+IHtcclxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0ID0gYCR7cGFkZGluZ1Njcm9sbH1weGA7XHJcbiAgfTtcclxuXHJcbiAgZnNMaWdodGJveEluc3RhbmNlc1tcImxpZ2h0Ym94XCJdLnByb3BzLm9uQ2xvc2UgPSAoKSA9PiB7XHJcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodCA9IGAwYDtcclxuICB9O1xyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyB2aXNpYmxlIGhlYWRlclxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG5cclxuICBjb25zdCBpbnZpc2libGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmludmlzaWJsZSAqXCIpO1xyXG4gIGNvbnN0IGhlYWRlclRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgIGludmlzaWJsZS5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICBlbC5zdHlsZS5vcGFjaXR5ID0gMTtcclxuICAgIH0pO1xyXG4gIH0sIDE1MDApO1xyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBJbml0aWFsaXplIHNsaWRlcnNcclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuXHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgLy8gVXNpbmdBcmVhc1NsaWRlclxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIGNvbnN0IHByZXZVc2luZ0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudXNpbmctYXJlYXNfX3BhZ2luYXRpb24tcHJldlwiKSxcclxuICAgIG5leHRVc2luZ0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudXNpbmctYXJlYXNfX3BhZ2luYXRpb24tbmV4dFwiKSxcclxuICAgIHVzQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudXNpbmctY2FyZF9fY2FyZFwiKTtcclxuXHJcbiAgY29uc3QgdXNpbmdBcmVhcyA9IG5ldyBTd2lwZXIoXCIudXNpbmctY2FyZF9fY29udGFpbmVyXCIsIHtcclxuICAgIHNwZWVkOiA0MDAsXHJcbiAgICBzcGFjZUJldHdlZW46IDEwLFxyXG4gICAgc2xpZGVzUGVyVmlldzogMSxcclxuICAgIGxvb3A6IHRydWUsXHJcbiAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgIG5leHRFbDogXCIudXNpbmctYXJlYXNfX3BhZ2luYXRpb24tbmV4dFwiLFxyXG4gICAgICBwcmV2RWw6IFwiLnVzaW5nLWFyZWFzX19wYWdpbmF0aW9uLXByZXZcIixcclxuICAgIH0sXHJcbiAgICBicmVha3BvaW50czoge1xyXG4gICAgICA1NTE6IHtcclxuICAgICAgICBsb29wOiBmYWxzZSxcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogNDAsXHJcbiAgICAgIH0sXHJcbiAgICAgIDc2OToge1xyXG4gICAgICAgIGxvb3A6IGZhbHNlLFxyXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDMsXHJcbiAgICAgICAgc3BhY2VCZXR3ZWVuOiAxMSxcclxuICAgICAgfSxcclxuICAgICAgMTAyNjoge1xyXG4gICAgICAgIGxvb3A6IGZhbHNlLFxyXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDQsXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICAvLyBjaGVjayByZXNpemUgc2xpZGVyXHJcbiAgZnVuY3Rpb24gaGFuZGxlVGFibGV0Q2hhbmdlKGUpIHtcclxuICAgIGlmIChlLm1hdGNoZXMpIHtcclxuICAgICAgdXNpbmdBcmVhcy5vbihcInNsaWRlQ2hhbmdlXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgdGhpcy5zbGlkZVRvKDYsIDEwMDApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5hY3RpdmVJbmRleCA9PSA3KSB7XHJcbiAgICAgICAgICB0aGlzLnNsaWRlVG8oMSwgMTAwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbiAgY29uc3QgbWVkaWFRdWVyeSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNTUxcHgpXCIpO1xyXG4gIG1lZGlhUXVlcnkuYWRkTGlzdGVuZXIoaGFuZGxlVGFibGV0Q2hhbmdlKTtcclxuICBoYW5kbGVUYWJsZXRDaGFuZ2UobWVkaWFRdWVyeSk7XHJcblxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIC8vIERyb25pY29TbGlkZXJcclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICBjb25zdCBkcm9uaWNvU2xpZGVyID0gbmV3IFN3aXBlcihcIi5kcm9uaWNvLXNsaWRlcl9fY29udGFpbmVyXCIsIHtcclxuICAgIHBhcmFsbGF4OiB0cnVlLFxyXG4gICAgc3BlZWQ6IDUwMCxcclxuICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgc3BhY2VCZXR3ZWVuOiAxMDAsXHJcbiAgICBlZmZlY3Q6IFwiZmFkZVwiLFxyXG4gICAgZmFkZUVmZmVjdDoge1xyXG4gICAgICBjcm9zc0ZhZGU6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgZ3JhYkN1cnNvcjogdHJ1ZSxcclxuICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgbmV4dEVsOiBcIi5kcm9uaWNvLXNsaWRlcl9fcGFnaW5hdGlvbi1uZXh0XCIsXHJcbiAgICAgIHByZXZFbDogXCIuZHJvbmljby1zbGlkZXJfX3BhZ2luYXRpb24tcHJldlwiLFxyXG4gICAgfSxcclxuICB9KTtcclxuICBjb25zdCBkcm9uaWNvSW1nU2xpZGVyID0gbmV3IFN3aXBlcihcIi5kcm9uaWNvLXNsaWRlcl9faW1nLWNvbnRhaW5lclwiLCB7XHJcbiAgICBwYXJhbGxheDogdHJ1ZSxcclxuICAgIHNwZWVkOiA1MDAsXHJcbiAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgbG9vcDogdHJ1ZSxcclxuICAgIGRpcmVjdGlvbjogXCJ2ZXJ0aWNhbFwiLFxyXG4gICAgc2ltdWxhdGVUb3VjaDogZmFsc2UsXHJcbiAgICBtb3VzZXdoZWVsQ29udHJvbDogZmFsc2UsXHJcbiAgICBmcmVlTW9kZTogZmFsc2UsXHJcbiAgICBzcGFjZUJldHdlZW46IDIwLFxyXG4gIH0pO1xyXG4gIGNvbnN0IGRyb25pY29JbWdOdW1TbGlkZXIgPSBuZXcgU3dpcGVyKFwiLmRyb25pY28tc2xpZGVyX19pbWdOdW0tY29udGFpbmVyXCIsIHtcclxuICAgIHBhcmFsbGF4OiB0cnVlLFxyXG4gICAgc3BlZWQ6IDUwMCxcclxuICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgbW91c2V3aGVlbENvbnRyb2w6IGZhbHNlLFxyXG4gICAgZnJlZU1vZGU6IGZhbHNlLFxyXG4gICAgc2ltdWxhdGVUb3VjaDogZmFsc2UsXHJcbiAgICBlZmZlY3Q6IFwiZmFkZVwiLFxyXG4gICAgZmFkZUVmZmVjdDoge1xyXG4gICAgICBjcm9zc0ZhZGU6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgYnJlYWtwb2ludHM6IHtcclxuICAgICAgNzY5OiB7XHJcbiAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcclxuICAgICAgICBzcGFjZUJldHdlZW46IDAsXHJcbiAgICAgIH0sXHJcbiAgICAgIDE0NDE6IHtcclxuICAgICAgICBzcGFjZUJldHdlZW46IDEwMCxcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIGRyb25pY29TbGlkZXIuY29udHJvbGxlci5jb250cm9sID0gZHJvbmljb0ltZ051bVNsaWRlcjtcclxuICBkcm9uaWNvSW1nTnVtU2xpZGVyLmNvbnRyb2xsZXIuY29udHJvbCA9IGRyb25pY29JbWdTbGlkZXI7XHJcblxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIC8vIE1vYmlsZURyb25pY29TbGlkZXJcclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICBjb25zdCBkcm9uaWNvTW9iaWxlU2xpZGVyID0gbmV3IFN3aXBlcihcIi5kcm9uaWNvLXNsaWRlcl9fbW9iaWxlLWNvbnRhaW5lclwiLCB7XHJcbiAgICBzcGVlZDogNTAwLFxyXG4gICAgc2xpZGVzUGVyVmlldzogMSxcclxuICAgIGxvb3A6IHRydWUsXHJcbiAgICBtb3VzZXdoZWVsQ29udHJvbDogZmFsc2UsXHJcbiAgICBmcmVlTW9kZTogZmFsc2UsXHJcbiAgICBzaW11bGF0ZVRvdWNoOiBmYWxzZSxcclxuICAgIGVmZmVjdDogXCJmYWRlXCIsXHJcbiAgICBmYWRlRWZmZWN0OiB7XHJcbiAgICAgIGNyb3NzRmFkZTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgIGVsOiBcIi5kcm9uaWNvLXNsaWRlcl9fbW9iaWxlLXBhZ2luYXRpb25cIixcclxuICAgICAgY2xpY2thYmxlOiB0cnVlLFxyXG4gICAgfSxcclxuICB9KTtcclxuXHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgLy8gV29ya1NsaWRlclxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIGNvbnN0IHdvcmtTbGlkZXIgPSBuZXcgU3dpcGVyKFwiLndvcmtfX2NvbnRhaW5lclwiLCB7XHJcbiAgICBzcGVlZDogNDAwLFxyXG4gICAgc2xpZGVzUGVyVmlldzogNixcclxuICAgIHNwYWNlQmV0d2VlbjogMjAsXHJcbiAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgIG5leHRFbDogXCIud29ya19fbmF2aWdhdGlvbi1uZXh0XCIsXHJcbiAgICAgIHByZXZFbDogXCIud29ya19fbmF2aWdhdGlvbi1wcmV2XCIsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBNYWluQ29kZVxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIGNvbnN0IGRyb25zQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50ZWNoLWRyb25pY29fX2ltZy1jb250YWluZXJcIiksXHJcbiAgICBkcm9uc0J0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRlY2gtZHJvbmljb19fYnRuXCIpLFxyXG4gICAgZHJvblRleHRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50ZWNoLWRyb25pY29fX3RleHRcIiksXHJcbiAgICBhY3RpdmUgPSBcImFjdGl2ZS1idG5cIjtcclxuXHJcbiAgaWYgKGRyb25zQ29udGFpbmVyKSB7XHJcbiAgICBkcm9uc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGVjaC1kcm9uaWNvX19idG5cIikpIHtcclxuICAgICAgICBkcm9uc0J0bnMuZm9yRWFjaCgoYnRuKSA9PiB7XHJcbiAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZShhY3RpdmUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRyb25UZXh0cy5mb3JFYWNoKCh0ZXh0KSA9PiB7XHJcbiAgICAgICAgICB0ZXh0LmNsYXNzTGlzdC5yZW1vdmUoYWN0aXZlKTtcclxuICAgICAgICAgIGlmICh0ZXh0LmRhdGFzZXQudGV4dCA9PSB0YXJnZXQuZGF0YXNldC50ZXh0KSB7XHJcbiAgICAgICAgICAgIHRleHQuY2xhc3NMaXN0LmFkZChhY3RpdmUpO1xyXG4gICAgICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZChhY3RpdmUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIC8vIExvdHRpZVN2Z09uTW91c2VPdmVyXHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgY29uc3QgdGVjaFRhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGVjaG5vbG9naWVzX190YWJzXCIpO1xyXG4gIGlmICh0ZWNoVGFiKSB7XHJcbiAgICB0ZWNoVGFiLm9ubW91c2VvdmVyID0gdGVjaFRhYi5vbm1vdXNlb3V0ID0gKGUpID0+IHtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGVjaG5vbG9naWVzX190YWJcIikpIHtcclxuICAgICAgICBjb25zdCB0ZWNoTG90dGllID0gdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoXCIubG90dGllLXRlY2hcIik7XHJcbiAgICAgICAgaWYgKHRlY2hMb3R0aWUpIHtcclxuICAgICAgICAgIGlmIChlLnR5cGUgPT0gXCJtb3VzZW92ZXJcIikge1xyXG4gICAgICAgICAgICB0ZWNoTG90dGllLnBsYXkoKTtcclxuICAgICAgICAgICAgdGVjaExvdHRpZS5zZXRMb29waW5nKHRydWUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGVjaExvdHRpZS5zZXRMb29waW5nKGZhbHNlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBGZWVkYmFja01vZGFsXHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBjb25zdCBtb2RhbFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcblxyXG4gICAgbW9kYWxXaW5kb3cuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBjb25zdCBtb2RhbFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcblxyXG4gICAgbW9kYWxXaW5kb3cuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG1vZGFsKHRyaWdnZXJTZWxlY3RvciwgbW9kYWxTZWxlY3Rvcikge1xyXG4gICAgY29uc3QgbW9kYWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRyaWdnZXJTZWxlY3RvciksXHJcbiAgICAgIG1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFNlbGVjdG9yKTtcclxuXHJcbiAgICBtb2RhbEJ0bi5mb3JFYWNoKChidG4pID0+IHtcclxuICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwobW9kYWxTZWxlY3RvcikpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbW9kYWxXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWNsb3NlXCIpID09IFwiXCIpIHtcclxuICAgICAgICBjbG9zZU1vZGFsKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaWYgKGUuY29kZSA9PT0gXCJFc2NhcGVcIiAmJiBtb2RhbFdpbmRvdy5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpIHtcclxuICAgICAgICBjbG9zZU1vZGFsKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG1vZGFsKFwiLmJveFwiLCBcIi5mZWVkYmFja1wiKTtcclxuXHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcbiAgLy8gRm9ybVxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZlZWRiYWNrX19mb3JtXCIpO1xyXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmb3JtU2VuZCk7XHJcblxyXG4gIGFzeW5jIGZ1bmN0aW9uIGZvcm1TZW5kKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBsZXQgZXJyb3IgPSBmb3JtVmFsaWRhdGUoZm9ybSk7XHJcblxyXG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7XHJcblxyXG4gICAgaWYgKGVycm9yID09PSAwKSB7XHJcbiAgICAgIGZvcm0uY2xhc3NMaXN0LmFkZChcIi5fc2VuZGluZ1wiKTtcclxuICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXCJwaHAvc2VuZG1haWwucGhwXCIsIHtcclxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgIGJvZHk6IGZvcm1EYXRhLFxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICBhbGVydChyZXN1bHQubWVzc2FnZSk7XHJcbiAgICAgICAgZm9ybS5yZXNldCgpO1xyXG4gICAgICAgIGZvcm0uY2xhc3NMaXN0LnJlbW92ZShcIl9zZW5kaW5nXCIpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFsZXJ0KFwi0J7RiNC40LHQutCwXCIpO1xyXG4gICAgICAgIGZvcm0uY2xhc3NMaXN0LnJlbW92ZShcIl9zZW5kaW5nXCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBmb3JtVmFsaWRhdGUoZm9ybSkge1xyXG4gICAgbGV0IGVycm9yID0gMDtcclxuICAgIGNvbnN0IGZvcm1SZXEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLl9yZXFcIik7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmb3JtUmVxLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGlucHV0ID0gZm9ybVJlcVtpXTtcclxuICAgICAgZm9ybVJlbW92ZUVycm9yKGlucHV0KTtcclxuXHJcbiAgICAgIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoXCJfbmFtZVwiKSkge1xyXG4gICAgICAgIGlmICghL15cXHd7NCwyMH0kL2dpLnRlc3QoaW5wdXQudmFsdWUpKSB7XHJcbiAgICAgICAgICBmb3JtQWRkRXJyb3IoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoXCJfcGhvbmVcIikpIHtcclxuICAgICAgICBpZiAoIS9eXFxkezQsMTJ9JC9nLnRlc3QoaW5wdXQudmFsdWUpKSB7XHJcbiAgICAgICAgICBmb3JtQWRkRXJyb3IoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICBpbnB1dC5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpID09PSBcImNoZWNrYm94XCIgJiZcclxuICAgICAgICBpbnB1dC5jaGVja2VkID09PSBmYWxzZVxyXG4gICAgICApIHtcclxuICAgICAgICBmb3JtQWRkRXJyb3IoaW5wdXQpO1xyXG4gICAgICAgIGVycm9yKys7XHJcbiAgICAgIH0gZWxzZSBpZiAoaW5wdXQudmFsdWUgPT09IFwiXCIpIHtcclxuICAgICAgICBmb3JtQWRkRXJyb3IoaW5wdXQpO1xyXG4gICAgICAgIGVycm9yKys7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBlcnJvcjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGZvcm1BZGRFcnJvcihpbnB1dCkge1xyXG4gICAgaW5wdXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiX2Vycm9yXCIpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChcIl9lcnJvclwiKTtcclxuICAgIGlucHV0Lm5leHRTaWJsaW5nLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QuYWRkKFwiX2Vycm9yXCIpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZm9ybVJlbW92ZUVycm9yKGlucHV0KSB7XHJcbiAgICBpbnB1dC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJfZXJyb3JcIik7XHJcblx0XHRpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKFwiX2Vycm9yXCIpO1xyXG5cdFx0aW5wdXQubmV4dFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC5yZW1vdmUoXCJfZXJyb3JcIik7XHJcbiAgfVxyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBUZXh0U2NyYW1ibGVcclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuXHJcbiAgY2xhc3MgVGV4dFNjcmFtYmxlIHtcclxuICAgIGNvbnN0cnVjdG9yKGVsKSB7XHJcbiAgICAgIHRoaXMuZWwgPSBlbDtcclxuICAgICAgdGhpcy5jaGFycyA9IFwiMDEyMzQ1Njc4OT48Ky0uJVwiO1xyXG4gICAgICB0aGlzLnVwZGF0ZSA9IHRoaXMudXBkYXRlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcbiAgICBzZXRUZXh0KG5ld1RleHQpIHtcclxuICAgICAgY29uc3Qgb2xkVGV4dCA9IHRoaXMuZWwuaW5uZXJUZXh0O1xyXG4gICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1heChvbGRUZXh0Lmxlbmd0aCwgbmV3VGV4dC5sZW5ndGgpO1xyXG4gICAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+ICh0aGlzLnJlc29sdmUgPSByZXNvbHZlKSk7XHJcbiAgICAgIHRoaXMucXVldWUgPSBbXTtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGZyb20gPSBvbGRUZXh0W2ldIHx8IFwiXCI7XHJcbiAgICAgICAgY29uc3QgdG8gPSBuZXdUZXh0W2ldIHx8IFwiXCI7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0MCk7XHJcbiAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0MCk7XHJcbiAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKHsgZnJvbSwgdG8sIHN0YXJ0LCBlbmQgfSk7XHJcbiAgICAgIH1cclxuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5mcmFtZVJlcXVlc3QpO1xyXG4gICAgICB0aGlzLmZyYW1lID0gMDtcclxuICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICB9XHJcbiAgICB1cGRhdGUoKSB7XHJcbiAgICAgIGxldCBvdXRwdXQgPSBcIlwiO1xyXG4gICAgICBsZXQgY29tcGxldGUgPSAwO1xyXG4gICAgICBmb3IgKGxldCBpID0gMCwgbiA9IHRoaXMucXVldWUubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHsgZnJvbSwgdG8sIHN0YXJ0LCBlbmQsIGNoYXIgfSA9IHRoaXMucXVldWVbaV07XHJcbiAgICAgICAgaWYgKHRoaXMuZnJhbWUgPj0gZW5kKSB7XHJcbiAgICAgICAgICBjb21wbGV0ZSsrO1xyXG4gICAgICAgICAgb3V0cHV0ICs9IHRvO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5mcmFtZSA+PSBzdGFydCkge1xyXG4gICAgICAgICAgaWYgKCFjaGFyIHx8IE1hdGgucmFuZG9tKCkgPCAwLjI4KSB7XHJcbiAgICAgICAgICAgIGNoYXIgPSB0aGlzLnJhbmRvbUNoYXIoKTtcclxuICAgICAgICAgICAgdGhpcy5xdWV1ZVtpXS5jaGFyID0gY2hhcjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIG91dHB1dCArPSBgPHNwYW4gY2xhc3M9XCJkdWRcIj4ke2NoYXJ9PC9zcGFuPmA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG91dHB1dCArPSBmcm9tO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLmVsLmlubmVySFRNTCA9IG91dHB1dDtcclxuICAgICAgaWYgKGNvbXBsZXRlID09PSB0aGlzLnF1ZXVlLmxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZSgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuZnJhbWVSZXF1ZXN0ID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlKTtcclxuICAgICAgICB0aGlzLmZyYW1lKys7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJhbmRvbUNoYXIoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoYXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuY2hhcnMubGVuZ3RoKV07XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNvbnN0IHBocmFzZXMgPSBbXHJcbiAgICBcIjcwLjUxMjMyMywgNDUuMTE5NzRcIixcclxuICAgIFwiMi4zNTEzLCAtNzguMjgzOTg2OTBcIixcclxuICAgIFwiNzQuMzIzMzQsIDI0LjM0NTIzXCIsXHJcbiAgICBcIi0xMi41MTIzMjMsIDQ1LjExOTc0XCIsXHJcbiAgICBcIjcyLjUxMjM0NCwgMy4xMjkwNDNcIixcclxuICAgIFwiLTcwLjUxMjMyMywgMjAuMTE5NzRcIixcclxuICAgIFwiODMuMTIzMzQxLCA0Mi43NTY1NlwiLFxyXG4gIF07XHJcblxyXG4gIGNvbnN0IG51bWJlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNjcnVtYmxlLXRleHRcIik7XHJcblxyXG4gIGZ1bmN0aW9uIHNjcnVtYmxlVGV4dChmeCwgbnVtKSB7XHJcbiAgICBmeCA9IG5ldyBUZXh0U2NyYW1ibGUobnVtKTtcclxuICAgIGxldCBjb3VudGVyID0gMDtcclxuICAgIGZ1bmN0aW9uIG5leHQoKSB7XHJcbiAgICAgIGZ4LnNldFRleHQocGhyYXNlc1tjb3VudGVyXSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dChuZXh0LCA4MDApO1xyXG4gICAgICB9KTtcclxuICAgICAgY291bnRlciA9IChjb3VudGVyICsgMSkgJSBwaHJhc2VzLmxlbmd0aDtcclxuICAgIH1cclxuICAgIG5leHQoKTtcclxuICB9XHJcblxyXG4gIG51bWJlcnMuZm9yRWFjaCgobnVtLCBpKSA9PiB7XHJcbiAgICBzY3J1bWJsZVRleHQoYGZ4JHtpfWAsIG51bSk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIE1vZGFsXHJcblxyXG4gIC8vIOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlOKAlFxyXG4gIC8vIFBhcmFsbGF4XHJcbiAgLy8g4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCU4oCUXHJcblxyXG4gIGNvbnN0IHBhcmFsYXhDbGFzcyA9IFwiLnJlbGxheFwiO1xyXG5cclxuICBjb25zdCBzY2VuZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHBhcmFsYXhDbGFzcyk7XHJcbiAgc2NlbmVzLmZvckVhY2goKHNjZW5lKSA9PiB7XHJcbiAgICBsZXQgcGFyYWxsYXggPSBuZXcgUGFyYWxsYXgoc2NlbmUsIHtcclxuICAgICAgcmVsYXRpdmVJbnB1dDogdHJ1ZSxcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCByZWxsYXggPSBuZXcgUmVsbGF4KHBhcmFsYXhDbGFzcywge1xyXG4gICAgY2VudGVyOiB0cnVlLFxyXG4gIH0pO1xyXG5cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICAvLyBvcGVuVmlkZW9cclxuICAvLyDigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJTigJRcclxuICBjb25zdCBkcm9uaWNvU2xpZGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIFwiLmRyb25pY28tc2xpZGVyX19pbWctY29udGFpbmVyXCJcclxuICApO1xyXG59KTtcclxuIl0sImZpbGUiOiJtYWluLm1pbi5qcyJ9
